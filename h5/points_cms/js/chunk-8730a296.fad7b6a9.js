(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8730a296","chunk-3f68be8f"],{"106a":function(t,e,a){"use strict";var i=a("7e90"),s=a.n(i);s.a},"1d85":function(t,e,a){"use strict";var i=a("5e5f"),s=a.n(i);s.a},"2af2":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"sts-icon",class:t._f("fmtStatusColor")(t.status),style:{marginLeft:t.point?"20px":0}},[t.point&&void 0!==t.status?a("i"):t._e(),t._v(t._s(t._f("fmtStatus")(t.status))+" ")])},s=[],n=(a("a9e3"),{"00":"申请中","01":"已通过","02":"未通过","03":"已编辑",10:"已开始",11:"已重启",20:"已暂停",30:"已取消",90:"已结束"}),o={name:"act-sts-icon",props:{status:[Number,String],point:Boolean},filters:{fmtStatus:function(t){return void 0===t?"":n[t]?n[t]:"未知"},fmtStatusColor:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(n[t]){case"已通过":return"color-green";case"申请中":case"已编辑":return"color-orange";case"未通过":return"color-red";case"已取消":return"color-black";case"已开始":case"已重启":return"color-green";case"已暂停":return"color-red";case"已结束":return"color-black";default:return"color-black"}}}},l=o,r=(a("1d85"),a("2877")),c=Object(r["a"])(l,i,s,!1,null,"7a38aebe",null);e["a"]=c.exports},"4b5e":function(t,e,a){},5048:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"control-panel",attrs:{title:"活动控制面板",visible:t.show,"destroy-on-close":""},on:{"update:visible":function(e){t.show=e},closed:t.onClose}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"btns-box"},["01"===t.status?a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-video-play"},on:{click:t.onStart}},[t._v("开始")]):t._e(),"20"===t.status?a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-refresh-right"},on:{click:t.onReStart}},[t._v("重启")]):t._e(),"10"===t.status?a("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-video-pause"},on:{click:t.onPause}},[t._v("暂停")]):t._e(),"10"===t.status||"11"===t.status||"20"===t.status?a("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-circle-close"},on:{click:t.onEnd}},[t._v("结束")]):t._e()],1),a("el-divider"),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small",plain:""},on:{click:function(e){t.show=!1}}},[t._v("关 闭")])],1)],1)},s=[],n=(a("a9e3"),a("d3b7"),{name:"control-panel",model:{prop:"visible",event:"change"},props:{visible:Boolean,id:[Number,String],status:[Number,String]},data:function(){return{show:!1,isLoading:!1}},watch:{visible:function(t){this.show=t}},methods:{onStart:function(){var t=this;this.$confirm("是否确认开始活动？").then((function(){t.changeActivityStatus("10")}))},onReStart:function(){var t=this;this.$confirm("是否确认重新开始活动？").then((function(){t.changeActivityStatus("11")}))},onPause:function(){var t=this;this.$confirm("是否确认暂停活动？").then((function(){t.changeActivityStatus("20")}))},onEnd:function(){var t=this;this.$confirm("是否确认结束活动？").then((function(){t.changeActivityStatus("90")}))},changeActivityStatus:function(t){var e=this;this.isLoading=!0,this.$http.serviceUpdateActSts({id:this.id,status:t}).then((function(t){e.show=!1,e.$parent.getData(e.id)})).finally((function(){e.isLoading=!1}))},onClose:function(){this.$emit("update:visible",this.show)}}}),o=n,l=(a("8d7a"),a("2877")),r=Object(l["a"])(o,i,s,!1,null,"0ec40407",null);e["default"]=r.exports},"5e5f":function(t,e,a){},"6ae2":function(t,e,a){"use strict";var i=a("e97b"),s=a.n(i);s.a},7055:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"popup-unissue",attrs:{title:"未发行额度处理申请",width:"50%",visible:t.show,"destroy-on-close":"","before-close":t.onCancel},on:{"update:visible":function(e){t.show=e},closed:t.onClose}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 未发行额度处理申请"),a("span",{staticClass:"desc"},[a("i",[t._v("*")]),t._v("为必填项")]),a("appl-sts-icon",{attrs:{status:t.form.status,point:""}})],1),a("el-form",{directives:[{name:"loading",rawName:"v-loading.lock",value:t.isLoading,expression:"isLoading",modifiers:{lock:!0}}],ref:"form",attrs:{model:t.form,size:"small","label-width":"180px",rules:t.rules,"hide-required-asterisk":!1}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"活动名称："}},[t._v(t._s(t.form.activity))]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"预算额度："}},[t._v(t._s(t._f("fmtMoney")(t.form.budgetAmount)))]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"备用额度："}},[t._v(t._s(t._f("fmtMoney")(t.form.imprestAmount)))]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请时间："}},[t._v(t._s(t._f("fmtCDate")(t.form.createTime)))]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请人："}},[t._v(t._s(t.form.creater))]),t.isEditPage?[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"编辑时间："}},[t._v(t._s(t.form.editTime))]),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"编辑人："}},[t._v(t._s(t.form.editer))])]:t._e(),a("el-form-item",{attrs:{label:"选择处理方式：",prop:"dealType"}},[a("el-select",{attrs:{placeholder:"请选择处理方式"},model:{value:t.form.dealType,callback:function(e){t.$set(t.form,"dealType",e)},expression:"form.dealType"}},[a("el-option",{attrs:{label:"活动返还",value:1}}),a("el-option",{attrs:{label:"活动作废",value:2}})],1)],1),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:300,rows:3,autosize:{minRows:2,maxRows:6},placeholder:"备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"附件上传："}},[a("attachment",{attrs:{list:t.form.attachments,size:"small"}})],1),a("el-form-item",[a("el-button",{attrs:{plain:""},on:{click:t.onCancel}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.onVerily}},[t._v(t._s(t.isEditPage?"保 存":"提 交"))])],1)],2)],1)},s=[],n=(a("b0c0"),a("a9e3"),a("d3b7"),a("5530")),o=a("f509"),l=a("fe54"),r=a("2f62"),c={name:"popup-unissue",components:{Attachment:o["a"],ApplStsIcon:l["a"]},model:{prop:"visible",event:"change"},props:{visible:Boolean,sid:[Number,String]},data:function(){return{isEditPage:!1,show:!1,isLoading:!1,form:{},rules:{dealType:[{required:!0,message:"请选择处理方式",trigger:"change"}]}}},computed:Object(n["a"])({},Object(r["b"])({accountInfo:"getAccountInfo"})),watch:{visible:function(t){this.show=t,t&&(this.sid?(this.isEditPage=!0,this.getData(this.sid)):this.form={createTime:new Date,activity:"活动1",creater:this.accountInfo.name})}},methods:{getData:function(t){var e=this;this.isLoading=!0,this.$http.serviceGetApplEditDetail({id:t}).then((function(t){e.form=Object(n["a"])({},t)})).finally((function(){e.isLoading=!1}))},onClose:function(){this.$emit("update:visible",this.show)},onVerily:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.$confirm("是否".concat(t.isEditPage?"保存修改":"确认提交","？")).then((function(){t.onSubmit()}))}))},onSubmit:function(){var t=this;this.isLoading=!0,this.$http.serviceCreateAppl(this.form).then((function(e){t.$message.success("提交成功"),t.show=!1})).catch((function(e){!e.code&&e.name?Promise.reject(e):t.$alert(e.message,"提交失败",{type:"error"})})).finally((function(){t.isLoading=!1}))},onCancel:function(){var t=this;this.$confirm("是否取消".concat(this.isEditPage?"编辑":"申请","？"),"取消确认",{type:"error"}).then((function(){t.isEditPage=!1,t.show=!1,t.form={}}))}}},u=c,d=(a("106a"),a("2877")),p=Object(d["a"])(u,i,s,!1,null,"5e8388ea",null);e["default"]=p.exports},"7aec":function(t,e,a){},"7e90":function(t,e,a){},"8b46":function(t,e,a){},"8d7a":function(t,e,a){"use strict";var i=a("93ab"),s=a.n(i);s.a},"90d5":function(t,e,a){"use strict";var i=a("8b46"),s=a.n(i);s.a},"93ab":function(t,e,a){},a7a3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"activity-detail"},[3===t.$route.matched.length?[a("el-row",{attrs:{gutter:t.gutter}},[a("el-col",{attrs:{span:18}},[a("el-new-card",[a("template",{slot:"header"},[a("div",[t._v(t._s(t.$route.meta.name)),a("act-sts-icon",{attrs:{status:t.info.status,point:""}})],1),a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-s-operation"},on:{click:t.popupCtrlPanel}},[t._v("活动控制面板")])],1),a("info-block",[a("info-item",{attrs:{label:"部门/企业名称："}},[t._v(t._s(t.info.deptName))]),a("info-item",{attrs:{label:"积分账户名称："}},[t._v(t._s(t.info.account)),a("acct-sts-icon",{attrs:{status:t.info.acctStatus,point:""}})],1),a("info-item",{attrs:{label:"担当："}},[t._v(t._s(t.info.contact))]),a("info-item",{attrs:{label:"业务归属："}},[t._v(t._s(t.info.busType))]),a("info-item",{attrs:{label:"活动模式："}},[t._v(t._s(t.info.mode))]),a("info-item",{attrs:{label:"活动类型："}},[t._v(t._s(t.info.type))]),a("info-item",{attrs:{label:"平台："}},[t._v(t._s(t.info.plat))]),a("info-item",{attrs:{label:"开始时间："}},[t._v(t._s(t._f("fmtDateTime")(t.info.startTime)))]),a("info-item",{attrs:{label:"结束时间："}},[t._v(t._s(t._f("fmtDateTime")(t.info.endTime)))]),a("info-item",{attrs:{label:"累计活动天数："}},[t._v(t._s(t.info.days))]),a("info-item",{attrs:{label:"活动简介：",block:""}},[t._v(t._s(t.info.intro))])],1),a("div",{staticClass:"btns-box"},[a("el-button",{attrs:{icon:"el-icon-s-order",size:"small"},on:{click:t.popAttachments}},[t._v("查看附件")]),a("span",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-document"},on:{click:t.toReport}},[t._v("查看报表")]),a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-notebook-2"},on:{click:t.toCrtdDetail}},[t._v("查看明细")])],1)],1)],2)],1),a("el-col",{attrs:{span:6}},[a("to-do-list",{attrs:{list:t.toDo,height:"232px"}})],1)],1),a("today-data",{attrs:{gutter:t.gutter,data:t.todayData}}),a("el-row",{attrs:{gutter:t.gutter}},[a("el-col",{attrs:{span:18}},[a("el-new-card",[a("template",{slot:"header"},[a("div",[t._v(" 积分池概览 "),a("span",{staticClass:"acct-sts",style:t._f("fmtAcctApplStatusColor")(2)},[a("i",{style:t._f("fmtAcctApplStatusColor")(2,"backgroundColor")}),t._v(" 提额申请中 ")])])]),a("amount-act",{attrs:{data:t.amountData}}),a("div",{staticClass:"btns-box"},[a("span",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-document-copy"},on:{click:t.popupChgRec}},[t._v("额度变更记录")]),a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-tickets"},on:{click:t.popupUseRec}},[t._v("备用额度使用申请记录")])],1),t.isEditor?a("span",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-document-remove"},on:{click:t.popupUnissue}},[t._v("申请处理未发行额度")]),a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-document-checked"},on:{click:t.popupUseImp}},[t._v("申请使用备用额度")]),a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-document-add"},on:{click:t.popupAddAmt}},[t._v("申请额度")])],1):t._e()])],2)],1),a("el-col",{attrs:{span:6}},[a("el-new-card",[a("template",{slot:"header"},[t._v("积分发行量排行")]),a("div",{staticClass:"issueAmount-list"},t._l(t.issueList,(function(e,i){return a("div",{key:"item"+i,staticClass:"issueAmount-item"},[a("div",[a("span",[a("i",[t._v(t._s(i+1+". "))]),t._v(t._s(e.name))]),a("span",[t._v(t._s(e.issue))]),a("span",[t._v(t._s(t._f("fmtFloat2Percent")(e.percent)))])]),a("div",{staticClass:"issueAmount-bar"},[a("span",{style:{width:Math.round(100*e.percent)+"%"}})])])})),0)],2)],1)],1),a("el-new-card",[a("el-form",{staticClass:"condition-bar",attrs:{inline:"",model:t.searchForm,size:"small"}},[a("el-form-item",[a("el-select",{model:{value:t.searchForm.behavior,callback:function(e){t.$set(t.searchForm,"behavior",e)},expression:"searchForm.behavior"}},[a("el-option",{attrs:{label:"全部",value:1}}),a("el-option",{attrs:{label:"已开始",value:2}}),a("el-option",{attrs:{label:"已结束",value:3}})],1)],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"认证状态"},model:{value:t.searchForm.verifiSts,callback:function(e){t.$set(t.searchForm,"verifiSts",e)},expression:"searchForm.verifiSts"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"已注册",value:1}}),a("el-option",{attrs:{label:"未注册",value:2}})],1)],1),a("el-form-item",[a("date-range",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),a("el-form-item",[a("el-button",{staticStyle:{"min-width":"75px"},attrs:{plain:"",type:"primary",loading:t.isChartsLoading},on:{click:t.searchData}},[t._v("查询")])],1)],1)],1),t.pointsData.pointsIssued?a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"用户行为统计",lazy:""}},[a("div",{staticClass:"charts-header"},[t._v(t._s(t.fmtCDateRange)),a("el-link",{attrs:{underline:!1,icon:"el-icon-download"}})],1),a("div",{staticClass:"charts-box"},[a("chart-user-behavior",{attrs:{datas:t.userBehaviorData}}),a("el-divider"),a("chart-points-issued",{attrs:{datas:t.pointsData.pointsIssued}},[t._v("统计本活动内，当前筛选条件下各用户行为发行积分数量的分布情况")]),a("el-divider"),a("chart-points-recyled",{attrs:{datas:t.pointsData.pointsRecyled}},[t._v("统计本活动内，当前筛选条件下各用户行为回收积分数量的分布情况")]),a("el-divider"),a("chart-points-chain",{attrs:{datas:t.pointsData.pointsChain}},[t._v("统计本次活动内，当前筛选条件下的已发行、已回收的环比统计情况")]),a("el-divider"),a("chart-points-growth-rate",{attrs:{datas:t.pointsData.pointsGrowthRate}},[t._v("统计本次活动内，当前筛选条件下的已发行、已回收的增长率")]),a("el-divider"),a("chart-points-recyled-src",{attrs:{datas:t.pointsData.pointsRecyledSrc}},[t._v("统计本次活动内，已回收积分在各部门的分布情况")])],1)]),a("el-tab-pane",{attrs:{label:"活动效果统计",lazy:""}},[a("div",{staticClass:"charts-header"},[t._v(t._s(t.fmtCDateRange)),a("el-link",{attrs:{underline:!1,icon:"el-icon-download"}})],1),a("div",{staticClass:"charts-box"},[a("chart-part-user",{attrs:{datas:t.activityEffectData.partUser}},[t._v("统计本次活动内，当前筛选条件下所有用户行为的参与用户数统计")]),a("el-divider"),a("chart-part-user-chain",{attrs:{datas:t.activityEffectData.partUserChain}},[t._v("统计本次活动内，当前筛选条件下各用户行为的参与用户数的环比与增长率")]),a("el-divider"),a("chart-part-times",{attrs:{datas:t.activityEffectData.partTimes}},[t._v("统计本次活动内，当前筛选条件下各用户行为的参与次数统计")]),a("el-divider"),a("chart-part-times-chain",{attrs:{datas:t.activityEffectData.partTimesChain}},[t._v("统计本次活动内，当前筛选条件下各活动用户参与次数的环比与增长率")])],1)]),a("el-tab-pane",{attrs:{label:"结算统计",lazy:""}},[a("div",{staticClass:"charts-header"},[t._v(t._s(t.fmtCDateRange)),a("el-link",{attrs:{underline:!1,icon:"el-icon-download"}})],1),a("div",{staticClass:"charts-box"},[a("chart-stmt-overview",{attrs:{datas:t.settlementData.overview}},[t._v("统计在当前筛选条件下所有由本活动发行的积分，已核销部分在各结算状态下的分布情况")]),a("el-divider"),a("chart-stmt-sts-rec",{attrs:{datas:t.settlementData.stsRec}},[t._v("统计在当前筛选条件下所有由本次活动发行的积分，已核销应收部分在各结算状态下的分布情况")]),a("el-divider"),a("chart-stmt-sts-pay",{attrs:{datas:t.settlementData.stsPay}},[t._v("统计在当前筛选条件下所有由本次活动发行的积分，已核销应付部分在各结算状态下的分布情况")]),a("el-divider"),a("chart-stmt-dept-rec",{attrs:{datas:t.settlementData.deptRec}},[t._v("统计在当前筛选条件下所有由本次活动发行的积分，已核销应收部分在各部门下的分布情况")]),a("el-divider"),a("chart-stmt-dept-pay",{attrs:{datas:t.settlementData.deptPay}},[t._v("统计在当前筛选条件下所有由本次活动发行的积分，已核销应付部分在各部门下的分布情况")])],1)]),a("el-tab-pane",{attrs:{label:"商品统计",lazy:""}},[a("div",{staticClass:"charts-header"},[t._v(t._s(t.fmtCDateRange)),a("el-link",{attrs:{underline:!1,icon:"el-icon-download"}})],1),a("div",{staticClass:"charts-box"},[a("chart-goods",{attrs:{datas:t.goodsData.goods}},[t._v("统计本次活动发行的积分，当前筛选条件下兑换商品的情况")]),a("el-divider"),a("chart-goods-chain",{attrs:{datas:t.goodsData.goodsChain}},[t._v("统计本次活动发行的积分，当前筛选条件下兑换商品的环比情况")])],1)]),a("el-tab-pane",{staticClass:"rule-parts",attrs:{label:"业务规则",lazy:""}},[a("h5",{staticClass:"sub-title"},[t._v("活动整体规则配置"),a("el-button",{attrs:{size:"small",icon:"el-icon-plus"}},[t._v("新建")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.info.wholeRules,stripe:"",size:"small"}},[a("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"120px"}}),a("el-table-column",{attrs:{prop:"name",label:"规则名称","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"desc",label:"规则说明","min-width":"150px"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))]),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))]),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100px"}},[t._v("未开始")]),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"danger",icon:"el-icon-video-pause"},on:{click:function(a){return t.stopRule(e.row.id)}}},[t._v("停用")])]}}],null,!1,4046295665)})],1),a("h5",{staticClass:"sub-title"},[t._v("用户行为规则配置 - 发行"),a("el-button",{attrs:{size:"small",icon:"el-icon-plus"}},[t._v("新建")])],1),t._l(t.info.behaviorIssueRules,(function(e){return[a("h5",{key:"issue-title"+e.id,staticClass:"sub-title",staticStyle:{"margin-top":"40px"}},[a("span",[t._v(t._s(e.name)),a("rule-sts-icon",{attrs:{status:1,point:""}})],1),a("div",[a("el-button",{attrs:{size:"small",plain:"",type:"danger",icon:"el-icon-video-pause"},on:{click:function(a){return t.stopRule(e.id)}}},[t._v("停用")]),a("div",[a("div",[a("strong",[t._v("开始时间: ")]),t._v("活动同步")]),a("div",[a("strong",[t._v("结束时间: ")]),t._v("活动同步")])])],1)]),a("el-table",{key:"issue-table"+e.id,staticStyle:{width:"100%"},attrs:{data:e.rules,stripe:"",size:"small"}},[a("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"120px"}}),a("el-table-column",{attrs:{prop:"name",label:"规则名称","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"desc",label:"规则说明","min-width":"150px"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))]),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))])],1)]})),a("h5",{staticClass:"sub-title"},[t._v("用户行为规则配置 - 核销"),a("el-button",{attrs:{size:"small",icon:"el-icon-plus"}},[t._v("新建")])],1),t._l(t.info.behaviorVerifiRules,(function(e){return[a("h5",{key:"issue-title"+e.id,staticClass:"sub-title",staticStyle:{"margin-top":"40px"}},[a("span",[t._v(t._s(e.name)),a("rule-sts-icon",{attrs:{status:5,point:""}})],1),a("div",[a("div",[a("div",[a("strong",[t._v("开始时间: ")]),t._v("活动同步")]),a("div",[a("strong",[t._v("结束时间: ")]),t._v("活动同步")])])])]),a("el-table",{key:"verifi-table"+e.id,staticStyle:{width:"100%"},attrs:{data:e.rules,stripe:"",size:"small"}},[a("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"120px"}}),a("el-table-column",{attrs:{prop:"name",label:"规则名称","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"desc",label:"规则说明","min-width":"150px"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))]),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center",width:"150px"}},[t._v(t._s(t._f("fmtDateTime")(new Date)))])],1)]}))],2)],1):t._e(),a("popup-lmt-chg-rec",{attrs:{visible:t.chgRecVisible,id:t.id},on:{"update:visible":function(e){t.chgRecVisible=e},popupAct:t.popupActIntro,popupDtl:t.popupUnissueDetail}}),a("popup-use-imp-rec",{attrs:{visible:t.useRecVisible,id:t.id},on:{"update:visible":function(e){t.useRecVisible=e},popupDtl:t.popupUseImpDetail}}),a("popup-act-intro",{attrs:{visible:t.actIntroVisible,aid:t.selectedId},on:{"update:visible":function(e){t.actIntroVisible=e}}}),a("popup-add-amt-detail",{attrs:{visible:t.addAmtDtlVisible,sid:t.selectedId},on:{"update:visible":function(e){t.addAmtDtlVisible=e},popupEdit:t.popupAddAmt}}),a("popup-use-imp-detail",{attrs:{visible:t.useImpDtlVisible,sid:t.selectedId},on:{"update:visible":function(e){t.useImpDtlVisible=e},popupEdit:t.popupUseImp}}),a("popup-unissue-detail",{attrs:{visible:t.unissueDtlVisible,sid:t.selectedId},on:{"update:visible":function(e){t.unissueDtlVisible=e},popupEdit:t.popupUnissue}}),a("popup-add-amt",{attrs:{visible:t.addAmtVisible,sid:t.selectedId},on:{"update:visible":function(e){t.addAmtVisible=e}}}),a("popup-use-imp",{attrs:{visible:t.useImpVisible,sid:t.selectedId},on:{"update:visible":function(e){t.useImpVisible=e}}}),a("popup-unissue",{attrs:{visible:t.unissueVisible,sid:t.selectedId},on:{"update:visible":function(e){t.unissueVisible=e}}}),a("control-panel",{attrs:{visible:t.ctrlPanelVisible,id:t.id,status:t.info.status},on:{"update:visible":function(e){t.ctrlPanelVisible=e}}}),a("popup-atta",{attrs:{visible:t.attaVisible,fileList:t.info.attachments},on:{"update:visible":function(e){t.attaVisible=e}}})]:a("router-view")],2)},s=[],n=(a("d81d"),a("45fc"),a("b0c0"),a("d3b7"),a("ac1f"),a("5319"),a("53ca")),o=a("5530"),l=a("b1f8"),r=a("ba46"),c=a("fb55"),u=a("3355"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"amount-container"},[a("div",{staticClass:"amount-inner"},[a("ul",{staticClass:"amount-datas"},[a("li",[a("label",[t._v("预算额度")]),a("span",[t._v(t._s(t._f("fmtMoney")(t.data.budgetAmount)))])]),a("li",[a("label",[t._v("备用额度")]),a("span",[t._v(t._s(t._f("fmtMoney")(t.data.imprestAmount)))])]),a("li",[a("label",[t._v("预算额度警戒线")]),a("span",[t._v(t._s(t._f("fmtFloat2Percent")(t.data.budgetAmountLine)))])]),a("li",[a("label",[t._v("已发行积分")]),a("span",[t._v(t._s(t._f("fmtMoney")(t.data.issued)))])]),a("li",[a("label",[t._v("待发行积分")]),a("span",[t._v(t._s(t._f("fmtMoney")(t.data.unIssued)))])]),a("li",[a("label",[t._v("备用额度警戒线")]),a("span",[t._v(t._s(t._f("fmtFloat2Percent")(t.data.imprestAmountLine)))])])]),a("div",{staticClass:"amount-chart"},[a("div",{staticClass:"amount-budget",style:{width:t.budgetWidth},attrs:{title:t.budgetTips}},[a("label",[t._v("预算额度")]),a("div",{staticClass:"budget-line",style:{left:t.budgetLinePos}}),a("div",{directives:[{name:"show",rawName:"v-show",value:"-"!==t.issuedWidth,expression:"issuedWidth !== '-'"}],staticClass:"budget-issued",style:{width:t.issuedWidth}},[a("span",[t._v("已发行积分："),a("strong",[t._v(t._s(t.issuedWidth))])])])]),a("div",{staticClass:"amount-imprest",style:{width:t.imprestWidth},attrs:{title:t.imprestTips}},[a("label",[t._v("备用额度")]),a("div",{staticClass:"imprest-line",style:{left:t.imprestLinePos}})])])])])},p=[],m=a("8975"),f={name:"amount-act",props:{data:{type:Object,required:!0}},computed:{budgetWidth:function(){var t=Object(m["a"])(this.data.budgetAmount/(this.data.budgetAmount+this.data.imprestAmount));return"-"===t?"50%":t},imprestWidth:function(){return 100-parseFloat(this.budgetWidth)+"%"},budgetLinePos:function(){return Object(m["a"])(this.data.budgetAmountLine)},imprestLinePos:function(){return Object(m["a"])(this.data.imprestAmountLine)},issuedWidth:function(){return Object(m["a"])(this.data.issued/(this.data.budgetAmount+this.data.imprestAmount))},budgetTips:function(){return"预算费用（元）："+Object(m["b"])(this.data.budget)},imprestTips:function(){return"备用金（元）："+Object(m["b"])(this.data.imprest)}}},h=f,b=(a("e08a"),a("2877")),v=Object(b["a"])(h,d,p,!1,null,"2322d3ca",null),_=v.exports,g=a("2af2"),y=a("5711"),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"sts-icon",class:t._f("fmtStatusColor")(t.status),style:{marginLeft:t.point?"20px":0}},[t.point&&void 0!==t.status?a("i"):t._e(),t._v(t._s(t._f("fmtStatus")(t.status))+" ")])},w=[],C=(a("a9e3"),{"00":"未开始",10:"已开始",11:"已重启",20:"已暂停",30:"已停用",40:"已结束"}),A={name:"rule-sts-icon",props:{status:[Number,String],point:Boolean},filters:{fmtStatus:function(t){return void 0===t?"":C[t]?C[t]:"未知"},fmtStatusColor:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(C[t]){case"未开始":case"已结束":return"color-black";case"已开始":case"已重启":return"color-green";case"已停用":case"已暂停":return"color-red";default:return"color-black"}}}},I=A,k=(a("e3d0"),Object(b["a"])(I,D,w,!1,null,"38b1882c",null)),S=k.exports,x=a("fa2d"),R=a("9db7"),V=a("1ff6"),L=a("c1df"),P=a.n(L),$=a("f05f"),T=a("544c"),E=a("89b5"),j=a("5782"),z=a("2e7c"),O=a("e688"),U=a("d6dd"),M=a("201b3"),F=a("7055"),N=a("5048"),B=a("5e34"),W=a("2f62"),q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chart-container"},[a("h5",{staticClass:"chart-title"},[t._v(" 用户行为统计 "),a("el-popover",{attrs:{content:t.$slots.default?t.$slots.default[0].text:"统计本活动内，当前筛选条件下各用户行为发行积分与回收积分数量的分布情况"}},[a("el-link",{attrs:{slot:"reference",underline:!1,icon:"el-icon-question"},slot:"reference"})],1)],1),a("div",{staticClass:"chart-main"},[a("div",{staticClass:"chart"},[a("div",{staticClass:"total"},[a("span",[t._v(t._s(t.total))]),t._v("总计")]),a("v-chart",{attrs:{options:t.options}})],1),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.datas,size:"small","show-summary":"","summary-method":t.getSummaries}},[a("el-table-column",{attrs:{prop:"name",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"colorTag"},[a("i"),t._v(t._s(e.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"integral",label:"积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtMoney")(e.row.integral)))]}}])}),a("el-table-column",{attrs:{label:"占比"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtFloat2Percent")(e.row.integral/t.total)))]}}])}),a("el-table-column",{attrs:{prop:"lastIntegral",label:"去年同期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtMoney")(e.row.lastIntegral)))]}}])}),a("el-table-column",{attrs:{prop:"lastProportion",label:"去年同期占比"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtFloat2Percent")(e.row.lastProportion)))]}}])}),a("el-table-column",{attrs:{label:"同比增长"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("fmtFloat2Percent")(Math.abs(e.row.integral-e.row.lastIntegral)/e.row.lastIntegral))),a("arrow-icon",{attrs:{value:e.row.integral-e.row.lastIntegral}})],1)]}}])})],1)],1)])])},Y=[],G=a("111f"),H={name:"chart-user-behavior",mixins:[G["a"]],data:function(){return{options:{tooltip:{formatter:"{b}<br/>积分：{c}<br/>占比：{d}%"},series:[{name:"用户行为统计",type:"pie",radius:["60%","90%"],label:{show:!1},labelLine:{show:!1},data:[]}]}}},methods:{isMatchCondition:function(t){return"integral"===t.property||"lastIntegral"===t.property}}},J=H,K=(a("90d5"),Object(b["a"])(J,q,Y,!1,null,"310c923a",null)),Q=K.exports,X={name:"account-detail",mixins:[V["a"]],components:{ElNewCard:l["a"],TodayData:r["a"],InfoBlock:c["a"],InfoItem:u["a"],AmountAct:_,ActStsIcon:g["a"],AcctStsIcon:y["a"],RuleStsIcon:S,ToDoList:x["a"],DateRange:R["a"],PopupLmtChgRec:$["default"],PopupUseImpRec:T["default"],PopupActIntro:E["default"],PopupAddAmtDetail:j["default"],PopupUseImpDetail:z["default"],PopupUnissueDetail:O["default"],PopupAddAmt:U["default"],PopupUseImp:M["default"],PopupUnissue:F["default"],ControlPanel:N["default"],PopupAtta:B["default"],ChartUserBehavior:Q},data:function(){return{id:0,gutter:40,amountData:{},toDo:[],todayData:[],searchForm:{status:null,verifiSts:null,startTime:null,endTime:null},dateRange:[],isLoading:!1,isChartsLoading:!1,fmtCDateRange:"",info:{},issueList:[{id:1,name:"签到",issue:62345,percent:.65},{id:2,name:"点赞",issue:52345,percent:.55},{id:3,name:"注册",issue:42345,percent:.45},{id:4,name:"发帖",issue:32345,percent:.35},{id:5,name:"评论",issue:22345,percent:.25}],selectedId:0,chgRecVisible:!1,useRecVisible:!1,actIntroVisible:!1,addAmtDtlVisible:!1,useImpDtlVisible:!1,unissueDtlVisible:!1,addAmtVisible:!1,useImpVisible:!1,unissueVisible:!1,ctrlPanelVisible:!1,attaVisible:!1,userBehaviorData:["已发行","已回收"].map((function(t,e){return{name:t,integral:275800,proportion:.33,lastIntegral:27e4,lastProportion:.33}}))}},computed:Object(o["a"])({},Object(W["b"])({accountInfo:"getAccountInfo"}),{isEditor:function(){return this.info.deptId===this.accountInfo.orgId},isGTMC:function(){return 1===this.accountInfo.orgId}}),watch:{dateRange:function(t){this.searchForm.startTime=t[0],this.searchForm.endTime=t[1]},isChartsLoading:function(t){if(!t){var e=this.dateRange[0]?P()(this.dateRange[0]).format("YYYY年MM月DD日 HH时mm分"):"",a=P()(this.dateRange[1]?this.dateRange[1]:P()()).format("YYYY年MM月DD日 HH时mm分");this.fmtCDateRange=e+" 至 "+a}}},created:function(){this.id=this.$route.query.id,this.id?this.getData(this.id):this.$router.replace("/404")},methods:{getData:function(t){var e=this;this.isLoading=!0,this.$http.serviceGetActDetail({id:t}).then((function(t){e.info=t.info,e.amountData=t.amountData,e.todayData=t.todayData,e.toDo=t.toDoList})).finally((function(){e.isLoading=!1}))},toReport:function(){this.$router.push({path:"/activityMgmt/actDetail/actReport",query:{id:this.$route.query.id}})},toCrtdDetail:function(){this.$router.push({path:"/activityMgmt/actDetail/actCrdtDetail",query:{id:this.$route.query.id}})},popupChgRec:function(){this.chgRecVisible=!0},popupUseRec:function(){this.useRecVisible=!0},popupActIntro:function(t){this.selectedId=t,this.actIntroVisible=!0},popupAddAmtDetail:function(t){this.selectedId=t,this.addAmtDtlVisible=!0},popupUseImpDetail:function(t){this.selectedId=t,this.useImpDtlVisible=!0},popupUnissueDetail:function(t){this.selectedId=t,this.unissueDtlVisible=!0},popupAddAmt:function(t){this.selectedId="object"!==Object(n["a"])(t)?t:null,this.addAmtVisible=!0},popupUseImp:function(t){this.selectedId="object"!==Object(n["a"])(t)?t:null,this.useImpVisible=!0},popupUnissue:function(t){this.selectedId="object"!==Object(n["a"])(t)?t:null,this.unissueVisible=!0},popAttachments:function(){this.attaVisible=!0},popupCtrlPanel:function(){this.ctrlPanelVisible=!0},searchData:function(){var t=this;this.isChartsLoading=!0,this.$http.serviceChartsData(this.searchForm).then((function(e){t.pointsData=e.pointsData,t.bussinessData=e.bussinessData,t.activityEffectData=e.activityEffectData,t.activityTypeData=e.activityTypeData,t.settlementData=e.settlementData,t.goodsData=e.goodsData})).finally((function(){t.isChartsLoading=!1}))},searchNameChange:function(t){t.some((function(t){return""===t}))&&(this.searchForm.name=[""])},stopRule:function(t){this.$confirm("是否确认停用该规则？",{type:"error"})}}},Z=X,tt=(a("6ae2"),Object(b["a"])(Z,i,s,!1,null,"065cf1bc",null));e["default"]=tt.exports},a8d6:function(t,e,a){},cfd3:function(t,e,a){"use strict";var i=a("a8d6"),s=a.n(i);s.a},e08a:function(t,e,a){"use strict";var i=a("4b5e"),s=a.n(i);s.a},e3d0:function(t,e,a){"use strict";var i=a("7aec"),s=a.n(i);s.a},e688:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"popup-use-imprest-detail",attrs:{title:"未发行额度处理申请详情",width:"50%",visible:t.show,"destroy-on-close":""},on:{"update:visible":function(e){t.show=e},closed:t.onClose}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}]},[a("info-block",[a("info-item",{attrs:{label:"活动名称："}},[t._v("活动1")]),a("info-item",{attrs:{label:"类型："}},[t._v("活动返还")]),a("info-item",{attrs:{label:"预算额度："}},[t._v(t._s(t._f("fmtMoney")(1e5)))]),a("info-item",{attrs:{label:"备用额度："}},[t._v(t._s(t._f("fmtMoney")(1e5)))])],1),a("info-block",[a("info-item",{attrs:{label:"申请人："}},[t._v("担当1")]),a("info-item",{attrs:{label:"申请时间："}},[t._v("2020-5-25 12:00")]),a("info-item",{attrs:{label:"编辑人："}},[t._v("担当2")]),a("info-item",{attrs:{label:"编辑时间："}},[t._v("2020-5-25 12:00")]),a("info-item",{attrs:{label:"申请状态："}},[a("appl-sts-icon",{attrs:{status:0}})],1),a("info-item",{attrs:{label:"审批时间："}},[t._v("-")]),a("info-item",{attrs:{label:"备注："}})],1),a("info-block",[a("info-item",{attrs:{label:"附件：",block:""}},[t.info.attachments?a("ul",{staticClass:"attachment-list"},t._l(t.info.attachments,(function(e,i){return a("li",{key:i},[a("span",[t._v(t._s(i+1)+". "+t._s(e.name))]),a("el-link",{attrs:{icon:"el-icon-download"},on:{click:function(a){return t.onDownLoad(e.url)}}},[t._v("下载")])],1)})),0):t._e()])],1),a("el-divider"),a("option-btns",{attrs:{status:t.isAppling,auth:t.optionsAuth,aid:t.info.id,type:"popup",verify:"serviceVerifyAppl"},on:{onEdit:t.toEditAppl,onCancel:t.changeCancel,onReject:t.changeNoPass,onPass:t.changePass,onClose:function(e){t.show=!1}}})],1)])},s=[],n=(a("a9e3"),a("d3b7"),a("5530")),o=a("fb55"),l=a("3355"),r=a("3c4e9"),c=a("fe54"),u=a("2f62"),d={name:"popup-use-imprest-detail",components:{InfoBlock:o["a"],InfoItem:l["a"],OptionBtns:r["a"],ApplStsIcon:c["a"]},model:{prop:"visible",event:"change"},props:{visible:Boolean,sid:[Number,String]},data:function(){return{show:!1,isLoading:!1,info:{}}},computed:Object(n["a"])({},Object(u["b"])({accountInfo:"getAccountInfo"}),{isAppling:function(){return 1===this.info.status||4===this.info.status?"isAppling":""},optionsAuth:function(){return this.accountInfo.isAdmin?this.info.deptId===this.accountInfo.orgId?"isEditor":"":"isAdmin"}}),watch:{visible:function(t){this.show=t,t&&this.getData(this.sid)}},methods:{getData:function(t){var e=this;this.isLoading=!0,this.$http.serviceGetApplDetail({id:t}).then((function(t){e.info=Object(n["a"])({},t)})).finally((function(){e.isLoading=!1}))},toEditAppl:function(){this.$emit("popupEdit",this.sid)},changePass:function(){this.changeApplicationStatus(0)},changeNoPass:function(){this.changeApplicationStatus(2)},changeCancel:function(){this.changeApplicationStatus(3)},changeApplicationStatus:function(t){var e=this;this.isLoading=!0,this.$http.serviceUpdateAcctApplSts({status:t}).then((function(a){e.info.status=t})).finally((function(){e.isLoading=!1}))},onClose:function(){this.$emit("update:visible",this.show)}}},p=d,m=(a("cfd3"),a("2877")),f=Object(m["a"])(p,i,s,!1,null,"bf3c3fb0",null);e["default"]=f.exports},e97b:function(t,e,a){}}]);
//# sourceMappingURL=chunk-8730a296.fad7b6a9.js.map