(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d3bcb53"],{"201b3":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"popup-use-imprest",attrs:{title:"备用额度使用申请",width:"50%",visible:t.show,"destroy-on-close":"","before-close":t.onCancel},on:{"update:visible":function(e){t.show=e},closed:t.onClose}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 备用额度使用申请"),i("span",{staticClass:"desc"},[i("i",[t._v("*")]),t._v("为必填项")]),i("appl-sts-icon",{attrs:{status:t.form.status,point:""}})],1),i("el-form",{directives:[{name:"loading",rawName:"v-loading.lock",value:t.isLoading,expression:"isLoading",modifiers:{lock:!0}}],ref:"form",attrs:{model:t.form,size:"small","label-width":"180px",rules:t.rules,"hide-required-asterisk":!1}},[i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"积分账户名称："}},[t._v(t._s(t.form.account))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请时预算额度："}},[t._v(t._s(t._f("fmtMoney")(t.form.budgetAmount)))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请时可用额度："}},[t._v(t._s(t._f("fmtMoney")(t.form.availableAmount)))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请时备用额度："}},[t._v(t._s(t._f("fmtMoney")(t.form.imprestAmount)))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请时间："}},[t._v(t._s(t._f("fmtCDate")(t.form.createTime)))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"申请人："}},[t._v(t._s(t.form.creater))]),t.isEditPage?[i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"编辑时间："}},[t._v(t._s(t.form.editTime))]),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"编辑人："}},[t._v(t._s(t.form.editer))])]:t._e(),i("el-form-item",{attrs:{label:"申请理由：",prop:"reason"}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:300,rows:3,autosize:{minRows:2,maxRows:6},placeholder:"请输入申请理由"},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1),i("el-form-item",{attrs:{label:"附件上传："}},[i("attachment",{attrs:{list:t.form.attachments,size:"small"}})],1),i("el-form-item",[i("el-button",{attrs:{plain:""},on:{click:t.onCancel}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.onVerily}},[t._v(t._s(t.isEditPage?"保 存":"提 交"))])],1)],2)],1)},n=[],s=(i("b0c0"),i("a9e3"),i("d3b7"),i("5530")),a=i("f509"),r=i("fe54"),l=i("2f62"),c={name:"popup-use-imprest",components:{Attachment:a["a"],ApplStsIcon:r["a"]},model:{prop:"visible",event:"change"},props:{visible:Boolean,sid:[Number,String]},data:function(){return{isEditPage:!1,show:!1,isLoading:!1,form:{},rules:{reason:[{required:!0,message:"请输入申请理由，长度不能超出300个汉字",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(l["b"])({accountInfo:"getAccountInfo"})),watch:{visible:function(t){this.show=t,t&&(this.sid?(this.isEditPage=!0,this.getData(this.sid)):this.form={createTime:new Date,account:this.accountInfo.account,creater:this.accountInfo.name})}},methods:{getData:function(t){var e=this;this.isLoading=!0,this.$http.serviceGetApplEditDetail({id:t}).then((function(t){e.form=Object(s["a"])({},t)})).finally((function(){e.isLoading=!1}))},onClose:function(){this.$emit("update:visible",this.show)},onVerily:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.$confirm("是否".concat(t.isEditPage?"保存修改":"确认提交","？")).then((function(){t.onSubmit()}))}))},onSubmit:function(){var t=this;this.isLoading=!0,this.$http.serviceCreateAppl(this.form).then((function(e){t.$message.success("提交成功"),t.show=!1})).catch((function(e){!e.code&&e.name?Promise.reject(e):t.$alert(e.message,"提交失败",{type:"error"})})).finally((function(){t.isLoading=!1}))},onCancel:function(){var t=this;this.$confirm("是否取消".concat(this.isEditPage?"编辑":"申请","？"),"取消确认",{type:"error"}).then((function(){t.isEditPage=!1,t.show=!1,t.form={}}))}}},f=c,u=(i("8484"),i("2877")),m=Object(u["a"])(f,o,n,!1,null,"860673d2",null);e["default"]=m.exports},4109:function(t,e,i){},"64ce":function(t,e,i){},7008:function(t,e,i){"use strict";var o=i("64ce"),n=i.n(o);n.a},8484:function(t,e,i){"use strict";var o=i("c826"),n=i.n(o);n.a},a434:function(t,e,i){"use strict";var o=i("23e7"),n=i("23cb"),s=i("a691"),a=i("50c4"),r=i("7b0b"),l=i("65f0"),c=i("8418"),f=i("1dde"),u=i("ae40"),m=f("splice"),d=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,h=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!m||!d},{splice:function(t,e){var i,o,f,u,m,d,v=r(this),_=a(v.length),x=n(t,_),w=arguments.length;if(0===w?i=o=0:1===w?(i=0,o=_-x):(i=w-2,o=h(p(s(e),0),_-x)),_+i-o>g)throw TypeError(b);for(f=l(v,o),u=0;u<o;u++)m=x+u,m in v&&c(f,u,v[m]);if(f.length=o,i<o){for(u=x;u<_-o;u++)m=u+o,d=u+i,m in v?v[d]=v[m]:delete v[d];for(u=_;u>_-o+i;u--)delete v[u-1]}else if(i>o)for(u=_-o;u>x;u--)m=u+o-1,d=u+i-1,m in v?v[d]=v[m]:delete v[d];for(u=0;u<i;u++)v[u+x]=arguments[u+2];return v.length=_-o+i,f}})},c740:function(t,e,i){"use strict";var o=i("23e7"),n=i("b727").findIndex,s=i("44d2"),a=i("ae40"),r="findIndex",l=!0,c=a(r);r in[]&&Array(1)[r]((function(){l=!1})),o({target:"Array",proto:!0,forced:l||!c},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),s(r)},c826:function(t,e,i){},f509:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"attachment-container",class:{isSmall:"small"===t.size}},["normal"===t.size?i("el-form-item",{attrs:{label:"附件:"}},[i("el-upload",{attrs:{action:"/attachment","show-file-list":!1,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,"on-error":t.handleError,"on-progress":t.handleProgress,"file-list":t.fileList}},[i("el-button",{attrs:{size:"small",icon:"el-icon-upload2",loading:t.isUploading}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("支持格式：.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png，单个文件不能超过20M")])],1)],1):i("el-upload",{attrs:{action:"/attachment","show-file-list":!1,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,"on-error":t.handleError,"on-progress":t.handleProgress,"file-list":t.fileList}},[i("el-button",{attrs:{size:"small",icon:"el-icon-upload2",loading:t.isUploading}},[t._v("选择附件")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("支持格式：.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png，单个文件不能超过20M")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.fileList,"show-header":"normal"===t.size,size:"mini","empty-text":"暂无附件"}},[i("el-table-column",{attrs:{label:"序号",type:"index",align:"center"}}),i("el-table-column",{attrs:{label:"附件名称",prop:"name",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["small"===t.size?i("span",[t._v(t._s(t._f("fmtName")(e.row.name,e.row,t.size)))]):t._e()]}}])}),"normal"===t.size?[i("el-table-column",{attrs:{label:"附件格式",prop:"format",align:"center"}}),i("el-table-column",{attrs:{label:"文件大小",prop:"size",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtSize")(e.row.size)))]}}],null,!1,3844785627)}),i("el-table-column",{attrs:{label:"上传时间",prop:"createTime",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("fmtDateTime")(e.row.createTime)))]}}],null,!1,1832337739)}),i("el-table-column",{attrs:{label:"上传人",prop:"creater",align:"center"}})]:t._e(),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-link",{attrs:{icon:"el-icon-download"},on:{click:function(i){return t.onDownLoad(e.row.url)}}},[t._v("下载")]),i("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"是否确认删除？",confirmButtonType:"danger"},on:{onConfirm:function(i){return t.onRemoveAttachment(e.row.fid)}}},[i("el-link",{attrs:{slot:"reference",icon:"el-icon-remove-outline",type:"danger"},slot:"reference"},[t._v("删除")])],1)]}}])})],2)],1)},n=[],s=(i("c740"),i("a434"),i("b0c0"),i("b680"),{name:"attachment",props:{list:Array,size:{type:String,default:"normal"}},data:function(){return{fileList:[],isUploading:!1}},watch:{list:{handler:function(t){this.fileList=t},immediate:!0}},filters:{fmtSize:function(t){return 0===parseInt(t/1024)?t+"B":0===parseInt(t/1024/1024)?parseFloat(t/1024).toFixed(2)+"KB":0===parseInt(t/1024/1024/1024)?parseFloat(t/1024/1024).toFixed(2)+"MB":void 0},fmtName:function(t,e,i){return t&&"small"===i&&e.format?t+"."+e.format.toLowerCase():t}},methods:{beforeUpload:function(t){var e=/[\s\S]*(.rar|.zip|.doc|.docx|.pdf|.xls|.xlsx|.txt|.jpg|.jpeg|.png)$/.test(t.name),i=t.size/1024/1024<20;return e||this.$message.error("文件格式只能是.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png的!"),i||this.$message.error("单个文件不能超过20M!"),e&&i&&(this.isUploading=!0),e&&i},handleProgress:function(t,e,i){},handleSuccess:function(t,e,i){this.isUploading=!1,this.fileList.push(t.body),this.$emit("update:list",this.fileList)},handleError:function(t,e,i){this.$message.error("上传失败："+t),this.isUploading=!1},onDownLoad:function(t){},onRemoveAttachment:function(t){var e=this.fileList.findIndex((function(e){return e.fid===t}));e>=0&&this.fileList.splice(e,1)}}}),a=s,r=(i("7008"),i("2877")),l=Object(r["a"])(a,o,n,!1,null,"afcef4cc",null);e["a"]=l.exports},f6bd:function(t,e,i){"use strict";var o=i("4109"),n=i.n(o);n.a},fe54:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"sts-icon",class:t._f("fmtStatusColor")(t.status),style:{marginLeft:t.point?"20px":0}},[t.point&&void 0!==t.status?i("i"):t._e(),t._v(t._s(t._f("fmtStatus")(t.status))+" ")])},n=[],s=(i("a9e3"),{0:"已完成",1:"申请中",2:"已编辑",3:"已取消",4:"未通过"}),a={name:"appl-sts-icon",props:{status:[Number,String],point:Boolean},filters:{fmtStatus:function(t){return void 0===t?"":s[t]?s[t]:"未知"},fmtStatusColor:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(s[t]){case"已完成":return"color-green";case"申请中":case"已编辑":return"color-orange";case"已取消":return"color-black";case"未通过":return"color-red";default:return"color-black"}}}},r=a,l=(i("f6bd"),i("2877")),c=Object(l["a"])(r,o,n,!1,null,"07d8ecd8",null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-6d3bcb53.37aa8b74.js.map