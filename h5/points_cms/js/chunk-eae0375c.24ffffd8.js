(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eae0375c","chunk-038fdc90"],{"1dec":function(e,t,r){"use strict";var n=r("5552"),a=r.n(n);a.a},"45fc":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").some,i=r("a640"),o=r("ae40"),l=i("some"),s=o("some");n({target:"Array",proto:!0,forced:!l||!s},{some:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"498a":function(e,t,r){"use strict";var n=r("23e7"),a=r("58a8").trim,i=r("c8d2");n({target:"String",proto:!0,forced:i("trim")},{trim:function(){return a(this)}})},"4c73":function(e,t,r){},5552:function(e,t,r){},"5cea":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"business-rules"},[r("div",{staticClass:"rule-name"},[e._t("header"),r("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.newRule}},[e._v("新建")])],2),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.saving,expression:"saving"}],staticStyle:{width:"100%"},attrs:{data:e.rules,stripe:"",size:"small"}},[r("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.unsave?r("el-input",{directives:[{name:"focus",rawName:"v-focus"}],class:{is_error:t.row.isError},attrs:{size:"small",placeholder:"请输入规则ID"},on:{input:function(r){return e.getRuleById(r,t.row)}},model:{value:t.row.rid,callback:function(r){e.$set(t.row,"rid",r)},expression:"scope.row.rid"}}):r("span",[e._v(e._s(t.row.rid))])]}}])}),r("el-table-column",{attrs:{prop:"name",label:"规则名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name||"-"))]}}])}),r("el-table-column",{attrs:{prop:"desc",label:"规则说明"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.desc||"-"))]}}])}),""===e.type?r("el-table-column",{attrs:{prop:"status",label:"状态",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.status||"-")+" ")]}}],null,!1,2571703812)}):e._e(),r("el-table-column",{attrs:{label:"操作",align:"center",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.unsave?r("span",[r("el-link",{attrs:{icon:"el-icon-document-add"},on:{click:function(r){return e.addRule(t.row)}}},[e._v("保存")])],1):r("span",[r("el-link",{staticStyle:{"margin-right":"5px"},attrs:{type:"warning",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRule(t.row)}}},[e._v("编辑")]),r("el-popconfirm",{attrs:{title:"是否确认删除？",icon:"el-icon-warning",iconColor:"#F56C6C",confirmButtonType:"danger",cancelButtonText:"按错了"},on:{onConfirm:function(r){return e.removeRule(t.row)}}},[r("el-link",{attrs:{slot:"reference",type:"danger",icon:"el-icon-remove-outline"},slot:"reference"},[e._v("删除")])],1)],1)]}}])})],1),r("div",{staticClass:"rule-id-err-msg"},[e._v(e._s(e.ridErrMsg))])],1)},a=[],i=(r("c740"),r("45fc"),r("a434"),r("b0c0"),r("d3b7"),r("25f0"),r("498a"),r("2b0e")),o={name:"business-rules",props:{type:{type:String,default:""},rules:{type:Array,default:function(){return[]}}},data:function(){return{ridErrMsg:"",inputTimer:null,saving:!1}},directives:{focus:{inserted:function(e){e.querySelector("input").focus()}}},methods:{newRule:function(){this.rules.push({rid:"",name:"",desc:"",unsave:!0,isError:!1})},addRule:function(e){var t=this;this.validRuleId(e).then((function(){t.setValue(e,"unsave",!1)})).catch((function(){}))},editRule:function(e){this.setValue(e,"unsave",!0)},removeRule:function(e){var t=this.rules.findIndex((function(t){return t.rid===e.rid}));t>=0&&this.rules.splice(t,1)},validRuleId:function(e){var t=this;return new Promise((function(r,n){if(""===e.rid.toString().trim())return t.ridErrMsg="保存失败，请正确填写规则ID",t.setValue(e,"isError",!0),void n(new Error("规则ID为空"));t.ridErrMsg="",t.setValue(e,"isError",!1),t.saving=!0,t.getRuleById(e.rid,e).then((function(e){return r()})).catch((function(r){t.ridErrMsg="保存失败，请正确填写规则ID",t.setValue(e,"isError",!0),n(r)})).finally((function(){t.saving=!1}))}))},getRuleById:function(e,t){var r=this;return new Promise((function(n,a){clearTimeout(r.inputTimer),r.inputTimer=setTimeout((function(){if(""===e)return t.name="",t.desc="",t.status="",void n();setTimeout((function(){var e={rid:"123",name:"456",desc:"789",status:""};t.name=e.name,t.desc=e.desc,t.status=e.status,n(t)}),500)}),200)}))},validRules:function(){return!this.rules.some((function(e){return e.unsave}))||(this.ridErrMsg="有规则尚未保存",!1)},setValue:function(e,t,r){t in e?e[t]=r:i["default"].set(e,t,r)}}},l=o,s=(r("fb2b"),r("2877")),c=Object(s["a"])(l,n,a,!1,null,"09dfaaa6",null);t["default"]=c.exports},"64ce":function(e,t,r){},"65de":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-activity-appliaction"},[r("el-new-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}]},[r("template",{slot:"header"},[r("div",{staticClass:"flex-vertical-center"},[e._v(" "+e._s(e.$route.meta.name)+" "),r("span",{staticClass:"desc"},[r("i",[e._v("*")]),e._v(" 为必填项")]),e.isEditPage?r("act-appl-sts-icon",{attrs:{status:e.form.status,point:""}}):e._e()],1)]),r("el-form",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isSubmiting,expression:"isSubmiting",modifiers:{fullscreen:!0,lock:!0}}],ref:"form",attrs:{"element-loading-text":"提交中...","label-width":"180px","inline-message":"",model:e.form,rules:e.rules,"hide-required-asterisk":!1}},[r("h5",{staticClass:"sub-title"},[e._v("基本信息")]),r("el-form-item",{attrs:{label:"活动名称:",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入活动名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"部门/企业名称:",prop:"deptId"}},[e.isAdmin?r("el-select",{attrs:{placeholder:"请选择部门",loading:e.deptLoading},on:{"visible-change":e.getDeptList},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}},e._l(e.deptOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):r("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}},[r("el-option",{attrs:{label:e.accountInfo.deptName,value:e.accountInfo.deptId}})],1)],1),r("el-form-item",{attrs:{label:"担当:",prop:"contact"}},[e.isAdmin?r("el-select",{attrs:{placeholder:"请选择担当"},model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}},[r("el-option",{attrs:{label:"担当1",value:"担当1"}})],1):r("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}},[r("el-option",{attrs:{label:e.accountInfo.name,value:e.accountInfo.name}})],1)],1),r("el-form-item",{attrs:{label:"业务所属:",prop:"busType"}},[r("el-select",{attrs:{placeholder:"请选择业务所属"},model:{value:e.form.busType,callback:function(t){e.$set(e.form,"busType",t)},expression:"form.busType"}},[r("el-option",{attrs:{label:"客户业务",value:2}}),r("el-option",{attrs:{label:"DLR业务",value:3}})],1)],1),r("el-form-item",{attrs:{label:"活动模式:",prop:"mode"}},[r("el-select",{attrs:{placeholder:"请选择活动模式"},model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},[r("el-option",{attrs:{label:"线上",value:2}}),r("el-option",{attrs:{label:"线下",value:3}})],1)],1),r("el-form-item",{attrs:{label:"活动类型:",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择活动类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[r("el-option",{attrs:{label:"常规",value:2}}),r("el-option",{attrs:{label:"节点",value:3}})],1)],1),r("el-form-item",{attrs:{label:"平台:",prop:"plat"}},[r("el-checkbox-group",{model:{value:e.form.plat,callback:function(t){e.$set(e.form,"plat",t)},expression:"form.plat"}},[r("el-checkbox",{attrs:{label:"App"}},[e._v("App")]),r("el-checkbox",{attrs:{label:"H5"}},[e._v("H5")]),r("el-checkbox",{attrs:{label:"小程序"}},[e._v("小程序")])],1)],1),2===e.form.type?r("el-form-item",{attrs:{label:"活动周期:",prop:"cycle1"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"请选择活动周期"},model:{value:e.form.cycle1,callback:function(t){e.$set(e.form,"cycle1",t)},expression:"form.cycle1"}})],1):e._e(),3===e.form.type?r("el-form-item",{attrs:{label:"活动周期:",prop:"cycle2"}},[r("el-new-date-picker",{staticStyle:{width:"400px"},model:{value:e.form.cycle2,callback:function(t){e.$set(e.form,"cycle2",t)},expression:"form.cycle2"}})],1):e._e(),r("el-form-item",{attrs:{label:"开启形式:",prop:"open"}},[r("el-select",{attrs:{placeholder:"请选择开启形式"},model:{value:e.form.open,callback:function(t){e.$set(e.form,"open",t)},expression:"form.open"}},[r("el-option",{attrs:{label:"手动启动",value:1}}),r("el-option",{attrs:{label:"自动启动（按照活动开始时间）",value:2}})],1)],1),r("el-form-item",{attrs:{label:"活动简介:",prop:"intro"}},[r("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:300,rows:3,autosize:{minRows:2,maxRows:6}},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),r("el-divider"),r("h5",{staticClass:"sub-title"},[e._v("积分池设置")]),r("el-form-item",{attrs:{label:"预算费用（元）:",prop:"budget"}},[r("el-input",{attrs:{placeholder:"请输入预算（元）"},model:{value:e.form.budget,callback:function(t){e.$set(e.form,"budget",t)},expression:"form.budget"}})],1),r("el-form-item",{attrs:{label:"预算额度:",prop:"budgetAmount"}},[r("el-input",{attrs:{placeholder:"请输入预算额度"},model:{value:e.form.budgetAmount,callback:function(t){e.$set(e.form,"budgetAmount",t)},expression:"form.budgetAmount"}})],1),r("el-form-item",{attrs:{label:"预算额度警戒线（%）:",prop:"budgetAmountLine"}},[r("el-input",{attrs:{placeholder:"请输入预算额度警戒值（触及警戒线发送系统通知，建议在预算额度内70%）"},model:{value:e.form.budgetAmountLine,callback:function(t){e.$set(e.form,"budgetAmountLine",e._n(t))},expression:"form.budgetAmountLine"}})],1),r("el-form-item",{attrs:{label:"备用金（元）:",prop:"imprest"}},[r("el-input",{attrs:{placeholder:"请输入备用金（元）"},model:{value:e.form.imprest,callback:function(t){e.$set(e.form,"imprest",t)},expression:"form.imprest"}})],1),r("el-form-item",{attrs:{label:"备用额度:",prop:"imprestAmount"}},[r("el-input",{attrs:{placeholder:"请输入备用额度"},model:{value:e.form.imprestAmount,callback:function(t){e.$set(e.form,"imprestAmount",t)},expression:"form.imprestAmount"}})],1),r("el-form-item",{attrs:{label:"备用额度警戒线（%）:",prop:"imprestAmountLine"}},[r("el-input",{attrs:{placeholder:"请输入备用额度警戒线（触及警戒线发送系统通知，建议在预算额度内70%）"},model:{value:e.form.imprestAmountLine,callback:function(t){e.$set(e.form,"imprestAmountLine",e._n(t))},expression:"form.imprestAmountLine"}})],1),r("el-divider"),r("h5",{staticClass:"sub-title"},[e._v("业务规则")]),r("business-rules",{ref:"wholeRules",attrs:{rules:e.form.wholeRules}},[r("span",{attrs:{slot:"header"},slot:"header"},[e._v("活动整体规则配置")])]),r("div",{staticClass:"bus-rules"},[r("div",{staticClass:"rule-name"},[e._v("用户行为规则配置 - 发行"),r("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.popup("behaviorIssueRules")}}},[e._v("新建")])],1),e._l(e.form.behaviorIssueRules,(function(t){return r("div",{key:t.id,staticClass:"sub-bus-rules"},[r("div",{staticClass:"rule-name"},[e._v(" "+e._s(t.name)+" "),r("span",[r("el-button",{attrs:{size:"small",plain:"",type:"warning",icon:"el-icon-edit-outline"},on:{click:function(r){return e.popup("behaviorIssueRules",t)}}},[e._v("编辑")]),r("el-popconfirm",{style:{marginLeft:"10px"},attrs:{title:"是否确认删除该用户行为？",icon:"el-icon-warning",iconColor:"#F56C6C",confirmButtonType:"danger",cancelButtonText:"否"},on:{onConfirm:function(r){return e.removeSub("behaviorIssueRules",t)}}},[r("el-button",{attrs:{slot:"reference",size:"small",plain:"",type:"danger",icon:"el-icon-remove-outline"},slot:"reference"},[e._v("删除")])],1)],1)]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.rules,stripe:""}},[r("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"120px"}}),r("el-table-column",{attrs:{prop:"name",label:"规则名称"}}),r("el-table-column",{attrs:{prop:"desc",label:"规则说明"}})],1)],1)}))],2),r("div",{staticClass:"bus-rules"},[r("div",{staticClass:"rule-name"},[e._v("用户行为规则配置 - 核销"),r("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.popup("behaviorVerifiRules")}}},[e._v("新建")])],1),e._l(e.form.behaviorVerifiRules,(function(t){return r("div",{key:t.id,staticClass:"sub-bus-rules"},[r("div",{staticClass:"rule-name"},[e._v(" "+e._s(t.name)+" "),r("span",[r("el-button",{attrs:{size:"small",plain:"",type:"warning",icon:"el-icon-edit-outline"},on:{click:function(r){return e.popup("behaviorVerifiRules",t)}}},[e._v("编辑")]),r("el-popconfirm",{style:{marginLeft:"10px"},attrs:{title:"是否确认删除该用户行为？",icon:"el-icon-warning",iconColor:"#F56C6C",confirmButtonType:"danger",cancelButtonText:"按错了"},on:{onConfirm:function(r){return e.removeSub("behaviorVerifiRules",t)}}},[r("el-button",{attrs:{slot:"reference",size:"small",plain:"",type:"danger",icon:"el-icon-remove-outline"},slot:"reference"},[e._v("删除")])],1)],1)]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.rules,stripe:""}},[r("el-table-column",{attrs:{prop:"rid",label:"规则ID",align:"center",width:"120px"}}),r("el-table-column",{attrs:{prop:"name",label:"规则名称"}}),r("el-table-column",{attrs:{prop:"desc",label:"规则说明"}})],1)],1)}))],2),r("el-divider"),r("h5",{staticClass:"sub-title"},[e._v("附件上传")]),r("attachment",{attrs:{list:e.form.attachment},on:{"update:list":function(t){return e.$set(e.form,"attachment",t)}}}),r("el-divider"),r("el-form-item",[r("el-button",{staticStyle:{width:"120px"},on:{click:e.onCancel}},[e._v("取 消")]),r("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.onVerily}},[e._v(e._s(e.isEditPage?"保 存":"提 交"))])],1)],1)],2),r("el-dialog",{attrs:{title:(e.behaviorRuleForm.name?"编辑":"新建")+"用户行为规则 - "+("behaviorIssueRules"===e.popupType?"发行":"核销"),width:"60%",visible:e.popupSign,"destroy-on-close":"","before-close":e.onCancelPopup},on:{"update:visible":function(t){e.popupSign=t}}},[r("business-rules",{ref:"behaviorRules",attrs:{rules:e.behaviorRuleForm.rules}},[r("div",{staticClass:"behavior-rule-name",attrs:{slot:"header"},slot:"header"},[r("label",[r("i",[e._v("*")]),e._v("用户行为名称：")]),r("el-input",{class:{is_error:""!==e.behaviorNameErrMsg},attrs:{size:"small",placeholder:"请输入用户行为名称"},on:{input:e.onInputRuleName},model:{value:e.behaviorRuleForm.name,callback:function(t){e.$set(e.behaviorRuleForm,"name",t)},expression:"behaviorRuleForm.name"}}),r("span",{staticClass:"behavior-name-err-msg"},[e._v(e._s(e.behaviorNameErrMsg))])],1)]),r("el-divider"),r("div",{staticClass:"btns-box"},[r("el-button",{on:{click:e.onCancelPopup}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",loading:e.behaviorSaving},on:{click:e.popupSave}},[e._v("保 存")])],1)],1)],1)},a=[],i=(r("c740"),r("d81d"),r("a434"),r("b0c0"),r("d3b7"),r("ac1f"),r("5319"),r("498a"),r("5530")),o=r("b1f8"),l=r("f509"),s=r("9436"),c=r("f7af"),u=r("5cea"),p=r("2f62"),m={name:"edit-account-application",components:{ElNewCard:o["a"],Attachment:l["a"],ActApplStsIcon:s["a"],ElNewDatePicker:c["a"],BusinessRules:u["default"]},data:function(){return{isEditPage:!1,deptOptions:[],form:{name:"",deptId:"",deptName:"",contact:"",busType:"",mode:"",type:"",plat:["App"],cycle1:"",cycle2:[],open:"",intro:"",budget:"",budgetAmount:"",budgetAmountLine:"",imprest:"",imprestAmount:"",imprestAmountLine:"",attachment:[],wholeRules:[],behaviorIssueRules:[],behaviorVerifiRules:[]},rules:{name:[{required:!0,max:50,message:"请填写活动名称，长度不能超过50个汉字",trigger:"blur"}],deptId:[{required:!0,message:"请选择部门/企业",trigger:"change"}],contact:[{required:!0,message:"请选择担当",trigger:"change"}],busType:[{required:!0,message:"请选择业务归属",trigger:"change"}],mode:[{required:!0,message:"请选择活动模式",trigger:"change"}],type:[{required:!0,message:"请选择活动类型",trigger:"change"}],plat:[{required:!0,type:"array",message:"请选择平台",trigger:"change"}],cycle1:[{required:!0,message:"请选择活动周期",trigger:"change"}],cycle2:[{required:!0,type:"array",message:"请选择活动周期",trigger:"change"}],open:[{required:!0,message:"请选择开启形式",trigger:"change"}],budget:[{required:!0,pattern:/^\d{1,15}$/,message:"请填写整数数字，长度不能超出15个数字",trigger:"blur"}],budgetAmount:[{required:!0,pattern:/^\d{1,15}$/,message:"请填写整数数字，长度不能超出15个数字",trigger:"blur"}],budgetAmountLine:[{required:!0,type:"number",min:0,max:100,message:"请填写0~100的整数数字",trigger:"blur"}],imprest:[{required:!0,pattern:/^\d{1,15}$/,message:"请填写整数数字，长度不能超出15个数字",trigger:"blur"}],imprestAmount:[{required:!0,pattern:/^\d{1,15}$/,message:"请填写整数数字，长度不能超出15个数字",trigger:"blur"}],imprestAmountLine:[{required:!0,type:"number",min:0,max:100,message:"请填写0~100的整数数字",trigger:"blur"}]},popupSign:!1,popupType:"",behaviorRuleForm:{},behaviorNameErrMsg:"",behaviorNameTimer:null,behaviorSaving:!1,deptLoading:!1,isSubmiting:!1,isLoading:!1}},computed:Object(i["a"])({},Object(p["b"])({accountInfo:"getAccountInfo"}),{isAdmin:function(){return this.accountInfo.isAdmin}}),created:function(){this.$route.query.id&&(this.isEditPage=!0,this.getApplInfoById())},methods:{getDeptList:function(e){var t=this;e&&this.deptOptions.length<=0&&(this.deptLoading=!0,this.$http.serviceGetDeptList().then((function(e){t.deptOptions=e.map((function(e){return{value:e.id,label:e.name}}))})).catch((function(){t.deptOptions=[]})).finally((function(){t.deptLoading=!1})))},getApplInfoById:function(e){var t=this;this.isLoading=!0,this.$http.serviceGetActApplDetail({id:e}).then((function(e){t.form=Object.assign({},e.info,e.configAmountInfo)})).finally((function(){t.isLoading=!1}))},onVerily:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.$confirm("是否".concat(e.isEditPage?"保存修改":"确认提交","？")).then((function(){e.onSubmit()}))}))},onSubmit:function(){var e=this;this.isSubmiting=!0,this.$http.serviceCreateAct(this.form).then((function(t){e.$message.success("提交成功"),e.$router.replace({path:"/activityMgmt/actApplDetail",query:{id:t.id}})})).catch((function(t){!t.code&&t.name?Promise.reject(t):e.$alert(t.message,"提交失败",{type:"error"})})).finally((function(){e.isSubmiting=!1}))},onCancel:function(){var e=this;this.$confirm("是否取消".concat(this.isEditPage?"编辑":"申请","？"),"取消确认",{type:"error"}).then((function(){e.$router.go(-1)}))},popup:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.behaviorRuleForm=Object.assign({},{name:"",rules:[]},t),this.popupSign=!0,this.popupType=e},closePopup:function(){this.popupSign=!1,this.behaviorRuleForm={},this.behaviorNameErrMsg=""},popupSave:function(){var e=this;this.behaviorSaving=!0,this.checkRuleName(this.behaviorRuleForm.name).then((function(){e.$refs.behaviorRules.validRules()&&e.$confirm("是否确认保存？").then((function(){e.form[e.popupType].push(e.behaviorRuleForm),e.closePopup()}))})).catch((function(){})).finally((function(){e.behaviorSaving=!1}))},onCancelPopup:function(){this.$confirm("是否取消"+(this.behaviorRuleForm.name?"编辑":"新建")+"用户行为规则？",{type:"warning"}).then(this.closePopup)},onInputRuleName:function(e){this.checkRuleName(e).catch((function(){}))},checkRuleName:function(e){var t=this;return new Promise((function(r,n){clearTimeout(t.behaviorNameTimer),t.behaviorNameTimer=setTimeout((function(){if(""===e.trim()||e.length>20)return t.behaviorNameErrMsg="请填写用户行为名称，长度不能超出20个汉字",void n(new Error);t.behaviorNameErrMsg="",t.isSameName(e).then((function(e){e?(t.behaviorNameErrMsg="用户行为名称不可重复，请重新输入",n(new Error)):r()}))}),200)}))},isSameName:function(e){return new Promise((function(e,t){setTimeout((function(){var t=Boolean(Math.floor(2*Math.random()));e(t)}),500)}))},removeSub:function(e,t){var r=this.form[e].findIndex((function(e){return e.name===t.name}));this.form[e].splice(r,1)}}},d=m,f=(r("8991"),r("2877")),b=Object(f["a"])(d,n,a,!1,null,"50c48e63",null);t["default"]=b.exports},7008:function(e,t,r){"use strict";var n=r("64ce"),a=r.n(n);a.a},"88b1":function(e,t,r){},8991:function(e,t,r){"use strict";var n=r("9ab1"),a=r.n(n);a.a},9436:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"sts-icon",class:e._f("fmtStatusColor")(e.status),style:{marginLeft:e.point?"20px":0}},[e.point&&void 0!==e.status?r("i"):e._e(),e._v(e._s(e._f("fmtStatus")(e.status))+" ")])},a=[],i=(r("a9e3"),{"00":"申请中","01":"已通过","02":"未通过","03":"已编辑",30:"已取消"}),o={name:"act-appl-sts-icon",props:{status:[Number,String],point:Boolean},filters:{fmtStatus:function(e){return void 0===e?"":i[e]?i[e]:"未知"},fmtStatusColor:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(i[e]){case"已通过":return"color-green";case"申请中":case"已编辑":return"color-orange";case"未通过":return"color-red";case"已取消":return"color-black";default:return"color-black"}}}},l=o,s=(r("1dec"),r("2877")),c=Object(s["a"])(l,n,a,!1,null,"453ada8c",null);t["a"]=c.exports},"9ab1":function(e,t,r){},a434:function(e,t,r){"use strict";var n=r("23e7"),a=r("23cb"),i=r("a691"),o=r("50c4"),l=r("7b0b"),s=r("65f0"),c=r("8418"),u=r("1dde"),p=r("ae40"),m=u("splice"),d=p("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,b=Math.min,h=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!m||!d},{splice:function(e,t){var r,n,u,p,m,d,g=l(this),y=o(g.length),_=a(e,y),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=y-_):(r=x-2,n=b(f(i(t),0),y-_)),y+r-n>h)throw TypeError(v);for(u=s(g,n),p=0;p<n;p++)m=_+p,m in g&&c(u,p,g[m]);if(u.length=n,r<n){for(p=_;p<y-n;p++)m=p+n,d=p+r,m in g?g[d]=g[m]:delete g[d];for(p=y;p>y-n+r;p--)delete g[p-1]}else if(r>n)for(p=y-n;p>_;p--)m=p+n-1,d=p+r-1,m in g?g[d]=g[m]:delete g[d];for(p=0;p<r;p++)g[p+_]=arguments[p+2];return g.length=y-n+r,u}})},b1f8:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"el-new-card",attrs:{shadow:"never"}},[e.$slots.header?r("div",{staticClass:"el-new-card-header",attrs:{slot:"header"},slot:"header"},[e._t("header")],2):e._e(),r("div",{staticClass:"el-new-card-body"},[e._t("default")],2)])},a=[],i={name:"el-new-card"},o=i,l=(r("ffb4"),r("2877")),s=Object(l["a"])(o,n,a,!1,null,"64b26a91",null);t["a"]=s.exports},c740:function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").findIndex,i=r("44d2"),o=r("ae40"),l="findIndex",s=!0,c=o(l);l in[]&&Array(1)[l]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!c},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(l)},c8d2:function(e,t,r){var n=r("d039"),a=r("5899"),i="​᠎";e.exports=function(e){return n((function(){return!!a[e]()||i[e]()!=i||a[e].name!==e}))}},f509:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"attachment-container",class:{isSmall:"small"===e.size}},["normal"===e.size?r("el-form-item",{attrs:{label:"附件:"}},[r("el-upload",{attrs:{action:"/attachment","show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-progress":e.handleProgress,"file-list":e.fileList}},[r("el-button",{attrs:{size:"small",icon:"el-icon-upload2",loading:e.isUploading}},[e._v("点击上传")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持格式：.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png，单个文件不能超过20M")])],1)],1):r("el-upload",{attrs:{action:"/attachment","show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-progress":e.handleProgress,"file-list":e.fileList}},[r("el-button",{attrs:{size:"small",icon:"el-icon-upload2",loading:e.isUploading}},[e._v("选择附件")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持格式：.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png，单个文件不能超过20M")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.fileList,"show-header":"normal"===e.size,size:"mini","empty-text":"暂无附件"}},[r("el-table-column",{attrs:{label:"序号",type:"index",align:"center"}}),r("el-table-column",{attrs:{label:"附件名称",prop:"name",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["small"===e.size?r("span",[e._v(e._s(e._f("fmtName")(t.row.name,t.row,e.size)))]):e._e()]}}])}),"normal"===e.size?[r("el-table-column",{attrs:{label:"附件格式",prop:"format",align:"center"}}),r("el-table-column",{attrs:{label:"文件大小",prop:"size",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("fmtSize")(t.row.size)))]}}],null,!1,3844785627)}),r("el-table-column",{attrs:{label:"上传时间",prop:"createTime",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("fmtDateTime")(t.row.createTime)))]}}],null,!1,1832337739)}),r("el-table-column",{attrs:{label:"上传人",prop:"creater",align:"center"}})]:e._e(),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",{attrs:{icon:"el-icon-download"},on:{click:function(r){return e.onDownLoad(t.row.url)}}},[e._v("下载")]),r("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"是否确认删除？",confirmButtonType:"danger"},on:{onConfirm:function(r){return e.onRemoveAttachment(t.row.fid)}}},[r("el-link",{attrs:{slot:"reference",icon:"el-icon-remove-outline",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],2)],1)},a=[],i=(r("c740"),r("a434"),r("b0c0"),r("b680"),{name:"attachment",props:{list:Array,size:{type:String,default:"normal"}},data:function(){return{fileList:[],isUploading:!1}},watch:{list:{handler:function(e){this.fileList=e},immediate:!0}},filters:{fmtSize:function(e){return 0===parseInt(e/1024)?e+"B":0===parseInt(e/1024/1024)?parseFloat(e/1024).toFixed(2)+"KB":0===parseInt(e/1024/1024/1024)?parseFloat(e/1024/1024).toFixed(2)+"MB":void 0},fmtName:function(e,t,r){return e&&"small"===r&&t.format?e+"."+t.format.toLowerCase():e}},methods:{beforeUpload:function(e){var t=/[\s\S]*(.rar|.zip|.doc|.docx|.pdf|.xls|.xlsx|.txt|.jpg|.jpeg|.png)$/.test(e.name),r=e.size/1024/1024<20;return t||this.$message.error("文件格式只能是.rar，.zip，.doc，.docx，.pdf，.xls，.xlsx，.txt，.jpg，.jpeg，.png的!"),r||this.$message.error("单个文件不能超过20M!"),t&&r&&(this.isUploading=!0),t&&r},handleProgress:function(e,t,r){},handleSuccess:function(e,t,r){this.isUploading=!1,this.fileList.push(e.body),this.$emit("update:list",this.fileList)},handleError:function(e,t,r){this.$message.error("上传失败："+e),this.isUploading=!1},onDownLoad:function(e){},onRemoveAttachment:function(e){var t=this.fileList.findIndex((function(t){return t.fid===e}));t>=0&&this.fileList.splice(t,1)}}}),o=i,l=(r("7008"),r("2877")),s=Object(l["a"])(o,n,a,!1,null,"afcef4cc",null);t["a"]=s.exports},f7af:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-date-picker",{ref:"datePicker",style:{width:e.width},attrs:{type:e.type,"range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",editable:!1,align:"right","popper-class":e.popperClass,"default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}})},a=[],i=r("c1df"),o=r.n(i),l={name:"el-new-date-picker",model:{prop:"value",event:"change"},props:{value:[Date,Array],type:{type:String,default:"daterange"},popperClass:String,width:{type:String,default:"240px"}},data:function(){return{val:null,pickerOptions:{disabledDate:function(e){return e.getTime()>o()().startOf("day").toDate().getTime()-1e3}}}},watch:{value:{handler:function(e){this.val=e},immediate:!0},val:function(e){this.$emit("change",e)}},methods:{focus:function(){this.$refs.datePicker.focus()}}},s=l,c=r("2877"),u=Object(c["a"])(s,n,a,!1,null,"034e15e2",null);t["a"]=u.exports},fb2b:function(e,t,r){"use strict";var n=r("88b1"),a=r.n(n);a.a},ffb4:function(e,t,r){"use strict";var n=r("4c73"),a=r.n(n);a.a}}]);
//# sourceMappingURL=chunk-eae0375c.24ffffd8.js.map